<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CloudMonitor | Dashboard de Infraestrutura (v3)</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
      .terminal-scroll::-webkit-scrollbar {
        width: 6px;
      }
      .terminal-scroll::-webkit-scrollbar-track {
        background: #1f2937;
      }
      .terminal-scroll::-webkit-scrollbar-thumb {
        background: #4b5563;
        border-radius: 4px;
      }
    </style>
  </head>

  <body
    class="bg-gray-100 font-sans text-gray-800 h-screen flex overflow-hidden"
  >
    <!-- Sidebar -->
    <aside class="w-64 bg-slate-900 text-white flex flex-col hidden md:flex">
      <div
        class="h-16 flex items-center px-6 border-b border-slate-700 justify-between"
      >
        <div class="flex items-center">
          <i class="fa-brands fa-docker text-blue-400 text-2xl mr-3"></i>
          <span class="text-xl font-bold tracking-wider">CloudMonitor</span>
        </div>

        <span class="text-xs bg-green-500 px-2 py-1 rounded font-bold">
          v3.0
        </span>
      </div>

      <nav class="flex-1 px-4 py-6 space-y-2">
        <a
          href="#"
          class="flex items-center px-4 py-3 bg-blue-600 rounded-lg text-white font-medium"
        >
          <i class="fa-solid fa-chart-line w-6"></i> Visão Geral
        </a>

        <a
          href="#"
          class="flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition"
        >
          <i class="fa-solid fa-server w-6"></i> Instâncias
        </a>

        <a
          href="#"
          class="flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition"
        >
          <i class="fa-solid fa-network-wired w-6"></i> Rede & VPC
        </a>

        <a
          href="#"
          class="flex items-center px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-white rounded-lg transition"
        >
          <i class="fa-solid fa-shield-halved w-6"></i> Segurança
        </a>
      </nav>

      <div
        class="p-4 border-t border-slate-700 text-xs text-slate-400 text-center"
      >
        Container ID:
        <span id="container-id" class="font-mono text-green-400">
          nginx-prod-v3
        </span>
      </div>
    </aside>

    <main class="flex-1 flex flex-col h-screen overflow-y-auto">
      <header
        class="bg-white shadow-sm h-16 flex items-center justify-between px-6"
      >
        <h1 class="text-2xl font-bold text-gray-800">Painel de Controle</h1>

        <div class="flex items-center space-x-4">
          <span
            class="text-xs bg-blue-100 text-blue-700 px-3 py-1 rounded-full font-bold"
          >
            VERSION 3.0
          </span>

          <div class="flex items-center space-x-2">
            <span class="flex h-3 w-3 relative">
              <span
                class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"
              ></span>
              <span
                class="relative inline-flex rounded-full h-3 w-3 bg-green-500"
              ></span>
            </span>
            <span class="text-sm font-medium text-gray-600"
              >Sistema Online</span
            >
          </div>
        </div>
      </header>

      <div class="p-6 space-y-6">
        <!-- cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div
            class="bg-white p-6 rounded-xl shadow border-l-4 border-blue-500"
          >
            <p class="text-sm text-gray-500 uppercase">Tráfego Atual</p>
            <p id="traffic-count" class="text-3xl font-bold">1,245 req/s</p>
          </div>

          <div
            class="bg-white p-6 rounded-xl shadow border-l-4 border-green-500"
          >
            <p class="text-sm text-gray-500 uppercase">Containers</p>
            <p id="container-count" class="text-3xl font-bold">3</p>
          </div>
        </div>

        <!-- gráfico cpu -->
        <div class="bg-white p-6 rounded-xl shadow">
          <div class="flex justify-between mb-4">
            <h2 class="font-bold">Uso de CPU</h2>

            <div class="flex gap-2">
              <button
                onclick="simulateTrafficSpike()"
                class="bg-red-100 px-3 py-2 rounded font-bold"
              >
                Simular Pico
              </button>

              <button
                onclick="clearLogs()"
                class="bg-gray-200 px-3 py-2 rounded font-bold"
              >
                Limpar Logs
              </button>
            </div>
          </div>

          <div class="h-64">
            <canvas id="cpuChart"></canvas>
          </div>
        </div>

        <!-- terminal -->
        <div class="bg-slate-900 rounded-xl overflow-hidden">
          <div class="bg-slate-800 px-4 py-2 flex justify-between items-center">
            <span class="text-xs text-slate-400 font-mono">
              /var/log/nginx/access.log
            </span>

            <span class="text-xs text-green-400 font-bold"> RUNNING v3 </span>
          </div>

          <div
            id="terminal-output"
            class="p-4 h-48 overflow-y-auto font-mono text-xs text-green-400 terminal-scroll"
          >
            <div>[SYSTEM] CloudMonitor v3 iniciado.</div>
            <div>[SYSTEM] Container nginx-prod-v3 em execução.</div>
            <div>[INFO] Sistema pronto.</div>
          </div>
        </div>
      </div>
    </main>

    <script>
      const ctxCpu = document.getElementById("cpuChart").getContext("2d");

      const cpuData = Array(20).fill(20);

      const cpuChart = new Chart(ctxCpu, {
        type: "line",
        data: {
          labels: Array(20).fill(""),
          datasets: [
            {
              label: "Uso de CPU",
              data: cpuData,
              borderColor: "#2563eb",
              backgroundColor: "rgba(37,99,235,0.1)",
              fill: true,
              tension: 0.4,
              pointRadius: 0,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          animation: false,
          scales: { y: { min: 0, max: 100 } },
        },
      });

      let baseCpu = 20;
      let isSpiking = false;

      function simulateTrafficSpike() {
        if (isSpiking) return;

        isSpiking = true;
        baseCpu = 90;

        addLog("[WARNING] Pico detectado");

        setTimeout(() => {
          document.getElementById("container-count").innerText = "5";
          addLog("[SYSTEM] Auto scaling executado");

          baseCpu = 30;
          isSpiking = false;
        }, 4000);
      }

      function clearLogs() {
        const terminal = document.getElementById("terminal-output");

        terminal.innerHTML = "";

        addLog("[SYSTEM] Logs limpos pelo operador", "text-yellow-400");
      }

      function addLog(msg, css = "text-green-400") {
        const terminal = document.getElementById("terminal-output");

        const div = document.createElement("div");

        div.className = css;

        div.innerText = "[" + new Date().toLocaleTimeString() + "] " + msg;

        terminal.appendChild(div);

        terminal.scrollTop = terminal.scrollHeight;
      }

      setInterval(() => {
        let v = baseCpu + (Math.random() * 10 - 5);

        cpuData.shift();
        cpuData.push(v);

        cpuChart.update();

        let traffic = isSpiking ? 8000 : 1200;
        traffic += Math.floor(Math.random() * 500);

        document.getElementById("traffic-count").innerText =
          traffic.toLocaleString() + " req/s";
      }, 1000);
    </script>
  </body>
</html>
